<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="keywords"  content="董刚, DavidDong, David, 董刚的博客, David Dong's Blog, 博客, 个人网站, 互联网, Web, 手机, 人机接口, Touch, Fingerprint，Github Pages TEE Java Python C Android">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Use Pypy to make Python run faster | David Dong’s Blog</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Use Pypy to make Python run faster" />
<meta name="author" content="david.dong" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This article introduced Pypy." />
<meta property="og:description" content="This article introduced Pypy." />
<link rel="canonical" href="http://localhost:4000/python/2021/06/03/Python-pypy.html" />
<meta property="og:url" content="http://localhost:4000/python/2021/06/03/Python-pypy.html" />
<meta property="og:site_name" content="David Dong’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-03T07:04:44+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Use Pypy to make Python run faster" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"david.dong"},"dateModified":"2021-06-03T07:04:44+08:00","datePublished":"2021-06-03T07:04:44+08:00","description":"This article introduced Pypy.","headline":"Use Pypy to make Python run faster","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/python/2021/06/03/Python-pypy.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/logo.png"},"name":"david.dong"},"url":"http://localhost:4000/python/2021/06/03/Python-pypy.html"}</script>
<!-- End Jekyll SEO tag -->



<meta property="article:tag" content="Python">


<link href="https://fonts.font.im/css?family=Poppins:400,900|Raleway|Roboto:400,900|Roboto+Mono&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://rsms.me/">
<link rel="stylesheet" href="https://rsms.me/inter/inter.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="icon" href="https://cdn.jsdelivr.net/gh/gangdong/gangdong.github.io@dev/assets/favicon.ico">

	<!-- default stylesheet monokai.sublime ! -->
	
	<link href="https://cdn.jsdelivr.net/gh/gangdong/gangdong.github.io@dev/assets/css/syntax/syntax.monokai.sublime.css" rel="stylesheet"/>
	

<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.0/dist/jquery.min.js"></script>

</head><body>
    <main class="container">
      <section class="about condensed">
	    <div class="about-header condensed">
			<div class="about-title">
				<a href="/blog/index.html">
				  <img src="https://cdn.jsdelivr.net/gh/gangdong/gangdong.github.io@dev/assets/avatar-11.png" alt="David Dong"/>
				</a>
				<div class = "title-meta">
					<h2 id="title">
					  <a href="/blog/index.html">David Dong</a>
					</h2>
					<p class = "tagline-small">Java/C/C#/Python</p>
				</div>
			</div>
			<p class="tagline">Java/C/C#/Python</p>
		</div>
		<!--put dark mode button here -->
		<div class = "about-footer condensed">
		  <!--put rss/code link here -->
			<div class="icon-box-container about-footer condensed"><div class = "icon-box" style = "padding-right:0px">
					<a id="dark-mode-toggle" class="togglemode dark-mode" onclick="toggleDarkMode()">
						<span id = "mode">Dark Mode</span>
					</a>
				</div>
				<!-- toggle dark/light display mode, should loading darkmode.js here for avoiding flicker when switching -->
				<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/gangdong/gangdong.github.io@dev/assets/js/darkmode.js"></script>
				<script type="text/javascript">
				$('.dark-mode').on('click',function(){
					$('.dark-mode').toggleClass('light-mode');
					if (document.getElementById("mode").innerHTML=="Light Mode")
						document.getElementById("mode").innerHTML="Dark Mode";
					else 
						document.getElementById("mode").innerHTML="Light Mode";
				})
				</script><div class = "icon-box">
					<a class="icon-rss" href="/rss.xml">
						<span>Subscribe</span>
					</a>
				</div><div class = "icon-box">
					<a class="icon-file-code" href="https://github.com/gangdong/gangdong.github.io">
						<span>Source Code</span>
					</a>
				</div></div>
		</div>
		
	    <!--show contact me -->
		<div class = "about-footer condensed social-container">
	    <p class = "contact about-footer condensed">CONTACT ME</p>
		<!-- put social link here -->
	      <ul class="social about-footer condensed" >
		   <a href="https://rainbow-ux.github.io/traveler-blog.github.io">
              <li>
                <i class="icon-picture"></i>
              </li>
           </a><a href="https://github.com/gangdong">
              <li>
                <i class="icon-github-circled"></i>
              </li>
            </a><a href="https://www.linkedin.com/in/刚-董-25208ba0/">
              <li>
                <i class="icon-linkedin-squared"></i>
              </li>
            </a><a href="mailto:dqdongg@hotmail.com">
              <li>
                <i class="icon-mail" style = "font-size: 27px"></i>
              </li>
            </a></ul>
		<!--put timestamp here -->
		<p class ="timestamp about-footer condensed">&copy; 2024</p>
		</div>
	  <!-- about box end here -->
      </section>
	  
      <section class="content">
        


<!-- add menu bar here! -->
<div class="post-container">
	<div  class = "menu-meta condensed">
		<!--put top menu here, display @ big screen (> $mobileW) -->
		<div  class = "menu-logo">BLOG</div>
		<div  class = "menu">
			<a href="/blog/index.html">
				<li class="icon-home">Home</li>
			</a><a href="/archive">
				<li class="icon-archive">Archives</li>
			</a><a href="/category">
				<li class="icon-tags">Categories</li>
			</a><a href="/about">
				<li class="icon-help-circled">About</li>
			</a>
		</div>
		<!--put hide menu button here, display @ small screen (< $mobileW) -->
		<div class = "menu-btn-box"><a class="menu-btn"></a></div>
		<!--put hide menu here, display @ small screen (< $mobileW) -->
		<div class="context-menu">
			<ul >
				<li>
					<a class="icon-home" href="/blog/index.html">Home</a>
				</li><li>
					<a class="icon-archive" href="/archive">Archives</a>
				</li><li>
					<a class="icon-tags" href="/category">Categories</a>
				</li><li>
					<a class="icon-help-circled" href="/about">About</a>
				</li>
			</ul>
		</div>
	</div>
</div>
<script type="text/javascript">
$('.menu-btn').on('click',function(e){
		
	e.stopPropagation();
	var tag = $('.context-menu');		
	$(tag).toggleClass('context-menu-show');
			
	var flag = true;
	/* hide the context-menu when other element is clicked */
	$(document).bind('click',function(e){
		var target = $(e.target);
		if(target.closest(tag).length == 0 && flag == true){
			$(tag).toggleClass('context-menu-show');
			flag = false;
		}
	});
})
</script><div class="post-container" style = "margin-bottom:1rem">
	<div class="posts-labelgroup" id="posts-labelgroup">
		<h1 id="posts-label">POST</h1>
	</div>  
	<!-- post title -->
	<h2 class="post-title-body">Use Pypy to make Python run faster</h2>
	<div class="post-meta">
		<div class="post-date icon-calendar" style = "padding-left:0px;font-size:14px">Jun 3, 2021</div>
		
		<!-- sidebar button for displaying/hiding sidebar -->
		<div class = "sidebar-btn-box"><a class="btn"></a></div>
		
	</div>
</div>
  <!-- post content here! -->
  <!-- set fix width box to put content! -->
<div class="post-viewer-container">
	<div class="post post-fix-width">
		<p><em>“If you want your code to run faster, you should use Pypy.”</em> - Guido van Rossum, the father of Python.<br />
To understand why Pypy is faster, we should know what makes Python slower.<!--more--></p>

<h2 id="what-does-make-python-slower">What does make Python slower?</h2>
<p>Python is a dynamic programming language, as we all know, unlike the static programming language <em>(C/C++/Rust…) - which are usually compiled ahead of time (AOT compilation)</em>, the dynamic programming language uses the interpreter to translate the source code line by line and runs it when executing. Therefore, The performance of the program interpreter determines the execution speed of Python.</p>

<div class="post-note info">
  <div class="header"></div>
  	<div class="body">
		<p>For static programming language, the compiler will convert the source code into machine code readable by a specific computer architecture. In other words, when executing the program, the execution is not the source code, but the machine code.<br />

		Because of the lack of translation process, the execution of the static programming language is usually faster than a dynamic programming language.
		</p>
  	</div>
</div>

<p>Here are some common Python interpreters:</p>

<table>
  <thead>
    <tr>
      <th>Interpreter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CPython</td>
      <td>interpreter implemented by C language</td>
    </tr>
    <tr>
      <td>Jython</td>
      <td>interpreter implemented by Java language</td>
    </tr>
    <tr>
      <td>IronPython</td>
      <td>interpreter implemented by .Net</td>
    </tr>
    <tr>
      <td>Pypy</td>
      <td>interpreter implemented by <code class="language-plaintext highlighter-rouge">RPython</code> - <em>a subset of Python</em></td>
    </tr>
  </tbody>
</table>

<h2 id="what-is-pypy">What is Pypy?</h2>
<p>We can think Pypy is a Python interpreter implemented in Python. Pypy is a very compatible Python interpreter, which is an alternative to CPython 2.7, 3.6, and the upcoming 3.7. It can significantly increase the speed when running an application with it.</p>

<blockquote>
  <p>Historically, Pypy has been used to mean two things. The first is the RPython translation toolchain for generating interpreters for dynamic programming languages. And the second is one particular implementation of Python produced with it. Because RPython uses the same syntax as Python, this generated version became known as Python interpreter written in Python. It is designed to be flexible and easy to experiment with.</p>
</blockquote>

<p>Above is the introduction of the Pypy in the <a href="https://doc.Pypy.org/en/latest/introduction.html">Pypy Documents website</a>, this website offers a lot of technical details and introduction of the Pypy.</p>

<h2 id="why-is-pypy-faster">Why is Pypy faster?</h2>
<p>The secret that the Pypy runs fast is that it uses <code class="language-plaintext highlighter-rouge">JIT</code> (Just-In-Time) compilation. JIT compilation is a combination of interpretation and pre-compilation. It can improve performance by using pre-compiling and improve the flexibility and cross-platform availability of interpretative language. That’s why Pypy can make Python perform so fast.</p>

<p>Here are the steps JIT compilation takes to provide faster performance:</p>
<ol>
  <li>Identify the most common components in code, such as functions in loops.</li>
  <li>The runtime converts these components into machine code.</li>
  <li>Optimize the generated machine code.</li>
  <li>Replace the previous implementation with an optimized machine code version.</li>
</ol>

<p>However, JIT isn’t all-powerful for everything. There are some limitations when using JIT.</p>

<ul>
  <li>It doesn’t work with C extensions, Pypy is best for pure Python applications. Whenever using the C extension module, it runs much slower than in CPython. The reason is that Pypy cannot optimize C extension modules because they are not fully supported. In this case, the Pypy team recommends removing the CPython extension and replacing it with a pure Python version. If not, CPython must be used.</li>
  <li>It only works for long-running programs.</li>
  <li>It does not perform precompilation. Pypy is not a fully compiled Python implementation. It compiles Python code, but it’s not a compiler for Python code. Python cannot be compiled into a separate binary and reused because of some inherent features of Python.</li>
</ul>

<h2 id="use-pypy">Use Pypy</h2>
<p>The Pypy needs to be installed before using it.</p>

<p>The <a href="http://Pypy.org/">http://Pypy.org/</a> offered the installation ZIPs for running on the different platforms. It can be downloaded and installed.</p>

<p>To install Pypy under Ubuntu, another method is using the command line.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>add-apt-repository ppa:Pypy/ppa
<span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install </span>Pypy Pypy-dev</code></pre></figure>

<p>If the installation is successful, open the terminal and enter Pypy, there will be the following similar prompts.
<img src="https://cdn.jsdelivr.net/gh/gangdong/gangdong.github.io@dev/assets/image/python-pypy-01.PNG" alt="installation" class="center-image" /></p>

<h2 id="performance">Performance</h2>
<p>To check the performance, I did an experiment, I wrote the below code and ran it with Pypy and CPython.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="n">time</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">8</span><span class="p">):</span>
    <span class="k">continue</span>
<span class="nf">print </span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span></code></pre></figure>

<p>when using Pypy to run the code.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">david</span><span class="nd">@david</span><span class="o">-</span><span class="n">VirtualBox</span><span class="p">:</span><span class="o">~/</span><span class="n">Study</span><span class="o">/</span><span class="n">python</span><span class="err">$</span> <span class="n">Pypy</span> <span class="n">test</span><span class="p">.</span><span class="n">py</span>
<span class="mf">0.148446083069</span></code></pre></figure>

<p>The result of using CPython to run the code.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">david</span><span class="nd">@david</span><span class="o">-</span><span class="n">VirtualBox</span><span class="p">:</span><span class="o">~/</span><span class="n">Study</span><span class="o">/</span><span class="n">python</span><span class="err">$</span> <span class="n">python3</span> <span class="n">test</span><span class="p">.</span><span class="n">py</span>
<span class="mf">19.179446935653687</span></code></pre></figure>

<p>The Pypy really made the python run faster!</p>

	</div>
	<!-- put sidebar! -->
	
	<div class = "sidebar-container">
	    
	    <div class = "sidebar-about-box" id = "sidebar">
		    
				<p class = "sidebar-title">About This Article</p>
			
			
				
					<P class = "sidebar-about-content sidebar-font-big">This article introduced Pypy.</P>
				
				
					<P class = "icon-link sidebar-about-content sidebar-font-medium" style = "margin-top:30px">Author: <a href="https://github.com/gangdong">david.dong</a></P>
				
					<P class = "icon-clock sidebar-about-content sidebar-font-medium">10 mins to read</P>
					<P class = "icon-book-1 sidebar-about-content sidebar-font-medium">3800 words</P>
				
					<P class = "icon-th-list sidebar-about-content sidebar-font-medium">Key Words: Python/Pypy</P>
				
				
				    <P class = "icon-hashtag sidebar-about-content sidebar-font-medium">Tags: 
					
					<a href="/category#Python">Python&nbsp;</a>
					
					</P>
				
			
		</div>
		
		
	    <div class="sidebar-toc-box">
			
			<p class = "sidebar-title">Table of Contents</p>
			<span class = "sidebar-font-medium sidebar-toc-content"><ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#what-does-make-python-slower">What does make Python slower?</a></li>
<li class="toc-entry toc-h2"><a href="#what-is-pypy">What is Pypy?</a></li>
<li class="toc-entry toc-h2"><a href="#why-is-pypy-faster">Why is Pypy faster?</a></li>
<li class="toc-entry toc-h2"><a href="#use-pypy">Use Pypy</a></li>
<li class="toc-entry toc-h2"><a href="#performance">Performance</a></li>
</ul></span>
			
		</div>
		
	</div>
	 
</div>
<!-- no sidebar, use flex width box! -->
<br>
<div class="post-container">
    <!-- post categories box! here  -->
    
   <div class="post-categories-meta">
		<div class="post-categories-box post-categories-box-hide"><a href="/category#Python">Python</a></div>
	</div>
  
  
  <div class = "share-box-meta">
  <!-- Go to www.addthis.com/dashboard to customize your tools -->
	
	<div class="addthis_inline_share_toolbox share-box"><span style ="padding: 2px">Share:</span></div>
	
	<!-- Put post veiw statistic here! -->
	<div class = "post-view">
	
		<span class = "icon-eye tooltip"><p class = "tooltiptext" style = "left:0%; margin-left: 0px">Viewers</p><span id="busuanzi_value_page_pv"></span></span>
		
	</div>
  </div>
  
  <!-- Related posts start here! -->
		
		<h1 id="posts-label">You may also like</h1>
		
	  <div class = "related-posts-box">
		<ul>
			
			<li><a href="/python/2019/05/11/Python-re.html">Python re module</a></li>
			
			<li><a href="/python/2019/05/03/Python-pack.html">Python struct.pack()</a></li>
			
			<li><a href="/python/2019/04/01/Python-coding-spec.html">Python 开发编码规范（转）</a></li>
			
			<li><a href="/python/2019/03/07/Python-pillow.html">Python Pillow library usage</a></li>
			
			<li><a href="/python/2019/01/23/Python-installation-ubuntu.html">Install python3.6 on ubuntu16.04</a></li>
			
		</ul>
	  </div>
	  
	
  <!-- Page navigation start here! -->
   <h1 id="posts-label">further reading</h1>
  
  <div class = "separator"></div>
  <div class="navigation-meta"><div class="navigation-bar">
	 
	 <a href="/android/linux/2021/05/09/Android-jack-issue.html"><span>Previous Post</span><br>Fixing the issue: Communication error with Jack server (35) when building AOSP</a>
	 
    </div><div class="navigation-bar"> 
	 
     <a href="/c%23/2021/09/11/Csharp-threadSynchronization.html"><span>Next Post</span><br>浅析 C# 中的线程同步 </a>
	 
    </div></div><br>
  <!-- comment box starts here! -->
    <!-- disqus start  --><!-- Gitalk start  -->
  <!-- Link Gitalk support file  -->
  <section class="gitalk">
  <div id="gitalk_thread"></div>
  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script type="text/javascript" src="/assets/js/md5.min.js"></script>
  <div id="gitalk-container"></div>
  <script type="text/javascript">
   var gitalk = new Gitalk({
   // gitalk parameters
   clientID: '5e24fc307693a6df3bc5',
   clientSecret: '28c9c17e1174c705c42e9bdc92f87cadcc4ec8b8',
   repo: 'gangdong.github.io',
   owner: 'gangdong',
   admin: ['gangdong'],
   id: md5(location.pathname),
   title: 'comments'
    });
   gitalk.render('gitalk-container');
  </script>
  </section>
  <!-- Gitalk end -->
  <br/><br/><br/><div class = "footer">© 2012-2021 David Dong. All rights reserved.</div>
  
  <br>
</div>

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script async type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-604f502a8198c9c9&domready=1"></script>


<!-- sidebar button, toggle display/hide sidebar -->
<script type="text/javascript">
        $('.btn').on('click',function(){
            $('.btn').toggleClass('btnc');
            $('.sidebar-container').toggleClass('sidebar-container-hide');
        })
</script>

      </section>
    </main><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MXGF3F8QN"></script>
      <script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'G-3MXGF3F8QN');
	</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body>
</html>
